
# ëª¨ë“ˆ ì†Œê°œ

ê°œë°œí•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ íŒŒì¼ì„ ì—¬ëŸ¬ê°œë¡œ ìª¼ê°œê³ ì í•˜ëŠ” ìš•êµ¬ëŠ” ê°•í•´ì§‘ë‹ˆë‹¤. ì´ ë•Œ ìª¼ê°œë†“ì€ í•˜ë‚˜ì˜ íŒŒì¼ì„ 'ëª¨ë“ˆ'ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.
ëª¨ë“ˆì€ ëŒ€ê²Œ í´ë˜ìŠ¤ í•˜ë‚˜ í˜¹ì€ ë³µìˆ˜ì˜ í•¨ìˆ˜ë¡œ êµ¬ì„±ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•˜ë‚˜ë¥¼ ë‹´ìŠµë‹ˆë‹¤.

ìë°”ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœê³„ëŠ” ì˜¤ë«ë™ì•ˆ ì–¸ì–´ ìˆ˜ì¤€ì—ì„œ ì§€ì›í•˜ëŠ” ëª¨ë“ˆ ë¬¸ë²• ì—†ì´ ì„±ì¥í•´ ì™”ìŠµë‹ˆë‹¤. ì´ ì ì´ ë¬¸ì œê°€ ë˜ì§„ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ˆê¸° ìŠ¤í¬ë¦½íŠ¸ëŠ” í¬ê¸°ë„ ì‘ê³  ê°„ë‹¨í–ˆê¸° ë•Œë¬¸ì´ì£ . ê·¸ë˜ì„œ ëª¨ë“ˆì˜ í•„ìš”ì„±ì´ ëŒ€ë‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.  

í•˜ì§€ë§Œ ìŠ¤í¬ë¦½íŠ¸ì˜ í¬ê¸°ê°€ ì ì°¨ ì»¤ì§€ê³  ë³µì¡í•´ì§€ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì»¤ë®¤ë‹ˆí‹°ëŠ” ëª¨ë“ˆì´ë¼ëŠ” ê°œë…ì„ ë„ì…í•´ ì½”ë“œë¥¼ ì²´ê³„í™” í•˜ë ¤ëŠ” ì—¬ëŸ¬ê°€ì§€ ì‹œë„ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤.   

ì˜ˆ:

- [AMD](https://en.wikipedia.org/wiki/Asynchronous_module_definition)ëŠ” ê°€ì¥ ì˜¤ë˜ëœ ëª¨ë“ˆ ì‹œìŠ¤í…œ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. [require.js](http://requirejs.org/)ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ì²˜ìŒ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.
- [CommonJS](http://wiki.commonjs.org/wiki/Modules/1.1)ëŠ” Node.js ì„œë²„ë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì§„ ëª¨ë“ˆ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
- [UMD](https://github.com/umdjs/umd)ëŠ” ì—¬ëŸ¬ ëª¨ë“ˆ ì‹œìŠ¤í…œì„ í•¨ê»˜ ì‚¬ìš©í•˜ê¸°ìœ„í•´ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. AMDì™€ CommonJSì™€ í˜¸í™˜ë©ë‹ˆë‹¤.

ìœ„ ëª¨ë“ˆ ì‹œìŠ¤í…œì€ ì˜¤ë˜ëœ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì°¾ì•„ ë³¼ ìˆ˜ ìˆëŠ”ë°, ì´ì œëŠ” ì—­ì‚¬ì˜ ë’¤ì•ˆê¸¸ë¡œ ì‚¬ë¼ì ¸ê°€ê³  ìˆìŠµë‹ˆë‹¤. ì–¸ì–´ ì°¨ì›ì—ì„œ ì§€ì›í•˜ëŠ” ëª¨ë“ˆ ì‹œìŠ¤í…œì´ 2015ë…„ë¶€í„° ë“±ì¥í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ì œëŠ” ê±°ì˜ ëŒ€ë¶€ë¶„ì˜ ì£¼ìš” ë¸Œë¼ìš°ì €ì™€ Node.jsì—ì„œ ëª¨ë“ˆ ì‹œìŠ¤í…œì„ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.  

## ëª¨ë“ˆì´ë€?

ëª¨ë“ˆì€ ë‹¨ìˆœí•œ íŒŒì¼ì…ë‹ˆë‹¤. í•˜ë‚˜ì˜ ìŠ¤í¬ë¦½íŠ¸ì£ . ì•„ì£¼ ê°„ë‹¨í•©ë‹ˆë‹¤.

ëª¨ë“ˆê°„ ê¸°ëŠ¥ ê³µìœ ëŠ” ì§€ì‹œì `export`ì™€ `import`ë¥¼ ì´ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

- `export` í‚¤ì›Œë“œë¥¼ ë³€ìˆ˜ë‚˜ í•¨ìˆ˜ ì•ì— ë¶™ì´ë©´, ì´ ë³€ìˆ˜ë‚˜ í•¨ìˆ˜ëŠ” íŒŒì¼ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `import` í‚¤ì›Œë“œëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ê¸°ëŠ¥ì„ ê°€ì ¸ì˜¬ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

íŒŒì¼ `sayHi.js` ë‚´ë¶€ì— ìˆëŠ” í•¨ìˆ˜ë¥¼ ì™¸ë¶€ë¡œ ë‚´ë³´ë‚´ëŠ”(export) ì˜ˆì‹œë¥¼ ì‚´í´ë³´ë„ë¡ í•˜ì£ .

```js
// ğŸ“ sayHi.js
export function sayHi(user) {
  alert(`Hello, ${user}!`);
}
```

ì´ì œ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ ìœ„ í•¨ìˆ˜ë¥¼ ê°€ì ¸ì˜¤ê³ (import) ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// ğŸ“ main.js
import {sayHi} from './sayHi.js';

alert(sayHi); // í•¨ìˆ˜
sayHi('John'); // Hello, John!
```

ë³¸ íŠœí† ë¦¬ì–¼ì€ ì‹¤í–‰ í™˜ê²½ì— ìƒê´€ ì—†ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì–¸ì–´ ìì²´ì— ëŒ€í•´ ë‹¤ë£¨ê³ ì í•˜ì˜€ìœ¼ë‚˜, ë¸Œë¼ìš°ì €ë¥¼ ë°ëª¨ í™˜ê²½ìœ¼ë¡œ ì‚¬ìš©ì¤‘ì´ë¯€ë¡œ ë¸Œë¼ìš°ì €ì—ì„œ ì–´ë–»ê²Œ ëª¨ë“ˆì´ ë™ì‘í•˜ëŠ”ì§€ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ëª¨ë“ˆì„ ì‚¬ìš©í•˜ë ¤ë©´ `<script type="module">` ê°™ì´ ì†ì„±ì„ ì„¤ì •í•´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. 

[codetabs src="say" height="140" current="index.html"]

ë¸Œë¼ìš°ì €ëŠ” ìŠ¤í¬ë¦½íŠ¸ ë‚´ import í‚¤ì›Œë“œë¥¼ ë§Œë‚«ì„ ë•Œ ìë™ìœ¼ë¡œ ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ê³  í‰ê°€í•œ ë‹¤ìŒ, ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

## ëª¨ë“ˆì˜ í•µì‹¬ ê¸°ëŠ¥

ê·¸ëƒ¥ "ì¼ë°˜ì ì¸" ìŠ¤í¬ë¦½íŠ¸ì™€ ëª¨ë“ˆì˜ ì°¨ì´ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?

ë¸Œë¼ìš°ì €ì™€ ì„œë²„ì‚¬ì´ë“œ ìë°”ìŠ¤í¬ë¦½íŠ¸ í™˜ê²½ì—ì„œ ëª¨ë‘ ì ìš©ë˜ëŠ” ëª¨ë“ˆì˜ ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. 

### "use strict"ì´ í•­ìƒ ì ìš©ë©ë‹ˆë‹¤

ëª¨ë“ˆì€ í•­ìƒ `use strict(ì—„ê²© ëª¨ë“œ)`ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì„ ì–¸ë˜ì§€ ì•Šì€ ë³€ìˆ˜ì— ê°’ì„ í• ë‹¹í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ì£ . 

```html run
<script type="module">
  a = 5; // error
</script>
```

ìœ„ ì˜ˆì‹œë¥¼ í†µí•´ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ ëª¨ë“ˆì€ ì—„ê²©ëª¨ë“œë¡œ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤. ëª¨ë“  í™˜ê²½ì—ì„œë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤.

### ëª¨ë“ˆ ë ˆë²¨ ìŠ¤ì½”í”„

ê° ëª¨ë“ˆì€ ìê¸°ë§Œì˜ ìƒìœ„ ë ˆë²¨ ìŠ¤ì½”í”„ë¥¼ ê°–ìŠµë‹ˆë‹¤. ì¦‰, ëª¨ë“ˆ ìµœìƒìœ„ ë ˆë²¨ì˜ ë³€ìˆ˜ì™€ í•¨ìˆ˜ëŠ” ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸(ëª¨ë“ˆ)ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 

ì•„ë˜ ì˜ˆì‹œë¥¼ í†µí•´ ì´ë¥¼ ì•Œì•„ë´…ì‹œë‹¤. ë‘ê°œì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì„í¬íŠ¸ í•œ ìƒí™©ì…ë‹ˆë‹¤. `user.js`ì—ì„œ ì„ ì–¸í•œ ë³€ìˆ˜ `user`ë¥¼ `hello.js`ì—ì„œ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë‹ˆ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

[codetabs src="scopes" height="140" current="index.html"]

ì™¸ë¶€ì—ì„œ ì‚¬ìš©í•˜ë ¤ëŠ” ëª¨ë“ˆì€ `export`í•´ì¤˜ì•¼í•˜ê³ , ë‚´ë³´ë‚´ì§„(export) ëª¨ë“ˆì„ ê°€ì ¸ì™€ ì‚¬ìš©í•˜ë ¤ë©´ `import`í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ `user.js`ë¥¼ `hello.js` ì•ˆì—ì„œ ë°”ë¡œ importí•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. `index.html`ì—ì„œ ê°€ì ¸ì˜¤ì§€ ë§ê³ ìš”.

ì´ì œ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ë„¤ìš”.

[codetabs src="scopes-working" height="140" current="hello.js"]

ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œë„ ê° `<script type="module">` ë§ˆë‹¤ ë…ë¦½ì ì¸ ìµœìƒìœ„ ë ˆë²¨ ìŠ¤ì½”í”„ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.

```html run
<script type="module">
  // ë³€ìˆ˜ userëŠ” ëª¨ë“ˆ ì•ˆì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤
  let user = "John";
</script>

<script type="module">
  *!*
  alert(user); // Error: user is not defined
  */!*
</script>
```

ë¶€ë“ì´í•˜ê²Œ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ "ì „ì—­(global)" ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´, `window` ê°ì²´ì— ë³€ìˆ˜ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹í•˜ê³ , `window.user`ë¡œ ì ‘ê·¼í•˜ë©´ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì •ë§ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ê¸¸ ê¶Œìœ í•©ë‹ˆë‹¤.

### ëª¨ë“ˆì€ ìµœì´ˆ ì„í¬íŠ¸ ì‹œ ë‹¨ í•œë²ˆë§Œ í‰ê°€ë©ë‹ˆë‹¤. 

ë™ì¼ ëª¨ë“ˆì´ ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê²½ìš°, ëª¨ë“ˆ ë‚´ ì½”ë“œëŠ” ìµœì´ˆ 1íšŒë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì‹¤í–‰ ì´í›„ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì´ ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ì£ . 

ì´ëŠ” ì¤‘ìš”í•œ ê²°ê³¼ë¥¼ ì´ˆë˜í•©ë‹ˆë‹¤. ì˜ˆì œë¥¼ ì‚´í´ë´…ì‹œë‹¤.

alert ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒ ê°™ì´ ì‹¤í–‰ ì‹œ ë¶€ì‘ìš©ì´ ë°œìƒí•˜ëŠ” ì½”ë“œë¥¼ ë‹´ê³  ìˆëŠ” ëª¨ë“ˆì€ ì—¬ëŸ¬ë²ˆ ì„í¬íŠ¸ ë˜ì–´ë„ ìµœì´ˆ í•œë²ˆë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

```js
// ğŸ“ alert.js
alert("Module is evaluated!");
```

```js
// ê°™ì€ ëª¨ë“ˆì„ ì—¬ëŸ¬ íŒŒì¼ì—ì„œ ì„í¬íŠ¸í•¨

// ğŸ“ 1.js
import `./alert.js`; // ëª¨ë“ˆì´ í‰ê°€ë©ë‹ˆë‹¤!

// ğŸ“ 2.js
import `./alert.js`; // (ì•„ë¬´ì¼ë„ ë°œìƒí•˜ì§€ ì•ŠìŒ)
```

í˜„ì—…ì—ì„œ ìµœìƒìœ„ ë ˆë²¨ ëª¨ë“ˆ ì½”ë“œëŠ” ëŒ€ê²Œ ì´ˆê¸°í™” ìš©ë„ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. ë°ì´í„° êµ¬ì¡°ë¥¼ ë§Œë“¤ê³ , ê·¸ êµ¬ì¡°ì— ë‚´ìš©ì„ ë¯¸ë¦¬ ì±„ì›Œë„£ì£ . ê·¸ë¦¬ê³  ì¬ì‚¬ìš© í•˜ê³  ì‹¶ì€ ê²½ìš° ì´ ëª¨ë“ˆì„ ë‚´ë³´ëƒ…ë‹ˆë‹¤.

ì¢€ ë” ì–´ë ¤ìš´ ì˜ˆì œë¥¼ ì‚´í´ë´…ì‹œë‹¤.

ëª¨ë“ˆì´ ê°ì²´ë¥¼ ë‚´ë³´ë‚´ëŠ” ê²½ìš°ë¥¼ ë³´ì‹œì£ .

```js
// ğŸ“ admin.js
export let admin = {
  name: "John"
};
```

ì´ ëª¨ë“ˆì´ ì—¬ëŸ¬ íŒŒì¼ì—ì„œ ì„í¬íŠ¸ë˜ì–´ë„ ì•ì—ì„œ ì„¤ëª…í•œ ë°” ì²˜ëŸ¼ í•œ ë²ˆë§Œ í‰ê°€ë©ë‹ˆë‹¤. `admin` ê°ì²´ê°€ ë§Œë“¤ì–´ì§€ê³ , ì´ ëª¨ë“ˆì„ ì„í¬íŠ¸ í•˜ëŠ” ëª¨ë“  íŒŒì¼ì— `admin`ê°ì²´ê°€ ì „ë‹¬ë©ë‹ˆë‹¤.

ê° íŒŒì¼ì—ì„œ ì „ë‹¬ë°›ì€ `admin` ê°ì²´ëŠ” ìœ ì¼ë¬´ì´í•œ ê°ì²´ì…ë‹ˆë‹¤. ëª¨ë‘ ë™ì¼í•œ ê°ì²´ë¥¼ ë°›ëŠ” ê±°ì£ . 

```js
// ğŸ“ 1.js
import {admin} from './admin.js';
admin.name = "Pete";

// ğŸ“ 2.js
import {admin} from './admin.js';
alert(admin.name); // Pete

*!*
// 1.jsì™€ 2.js ëª¨ë‘ ê°™ì€ ê°ì²´ë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤.
// 1.jsì—ì„œ ë³€í™”ëœ ê°ì²´ê°€ 2.jsì—ì„œë„ ë³´ì´ëŠ” êµ°ìš”.
*/!*
```

ì, ë‹¤ì‹œ ì •ë¦¬í•´ë´…ì‹œë‹¤. ëª¨ë“ˆì€ ë‹¨ í•œë²ˆë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ë‚´ë³´ë‚´ê¸°(exports)ê°€ ë§Œë“¤ì–´ì§€ë©´ í•´ë‹¹ ëª¨ë“ˆì€ ëª¨ë“  ê°€ì ¸ì˜¤ê¸° íŒŒì¼ì—ì„œ ê³µìœ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ `admin` ê°ì²´ì— ë­”ê°€ ë³€í™”ê°€ ìˆìœ¼ë©´, ë‹¤ë¥¸ ëª¨ë“ˆë“¤ì€ ì´ ë³€í™”ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ° íŠ¹ì§•ì€ í™˜ê²½ì„¤ì •ì´ í•„ìš”í•œ ëª¨ë“ˆì—ì„œ ìœ ìš©í•˜ê²Œ ì“°ì…ë‹ˆë‹¤. ì²«ë²ˆì§¸ import ì—ì„œ í”„ë¡œí¼í‹°ë¥¼ ì„¤ì •í•˜í•˜ë©´, ë‹¤ë¥¸ íŒŒì¼ì—ì„œ ì´ ì„¤ì •ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

 `admin.js` ëª¨ë“ˆì„ ì˜ˆë¥¼ë“¤ì–´ ì„¤ëª…í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. `admin` ê°ì²´ëŠ” ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ ì´ ëª¨ë“ˆ ì´ì™¸ì˜ íŒŒì¼ì—ì„œ ìˆ˜ì •ë˜ë©´ ì•ˆë©ë‹ˆë‹¤.     

```js
// ğŸ“ admin.js
export let admin = { };

export function sayHi() {
  alert(`Ready to serve, ${admin.name}!`);
}
```

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì§„ì… ìŠ¤í¬ë¦½íŠ¸ì¸ `init.js`ì—ì„œ `admin.name`ì„ ì„¤ì •í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ì´ì œ `admin`ê°ì²´ì˜ ì´ë¦„ì„ ë‹¤ë¥¸ íŒŒì¼ë“¤ì´ ëª¨ë‘ ë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. `admin.js`ì—ì„œë„ ì´ ë³€í™”ë¥¼ ë³¼ ìˆ˜ ìˆì£ .

```js
// ğŸ“ init.js
import {admin} from './admin.js';
admin.name = "Pete";
```

```js
// ğŸ“ other.js
import {admin, sayHi} from './admin.js';

alert(admin.name); // *!*Pete*/!*

sayHi(); // Ready to serve, *!*Pete*/!*!
```

### import.meta

`import.meta` ê°ì²´ëŠ” í˜„ì¬ ëª¨ë“ˆì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

ì‹¤í–‰ í™˜ê²½ì— ë”°ë¼ ì •ë³´ì˜ ë‚´ìš©ì€ ë‹¤ë¦…ë‹ˆë‹¤. ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„  ìŠ¤í¬ë¦½íŠ¸ì˜ url, HTMLì•ˆì— ìˆëŠ” ëª¨ë“ˆì˜ ê²½ìš° í˜„ì¬ ì›¹í˜ì´ì§€ì˜ url ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```html run height=0
<script type="module">
  alert(import.meta.url); // script url (ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ê°€ ìˆëŠ” html í˜ì´ì§€ì˜ url)
</script>
```

### ëª¨ë“ˆì—ì„œ ìµœìƒìœ„ ë ˆë²¨ì˜ "this"

ì‚¬ì†Œí•œ ê¸°ëŠ¥ì´ì§€ë§Œ, ì„¤ëª…ì˜ ì™„ì „ì„±ì„ ìœ„í•´ ì´ ë‚´ìš©ì„ ì–¸ê¸‰í•˜ê³  ë„˜ì–´ê°€ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤. 

ëª¨ë“ˆì˜ ìµœìƒìœ„ ë ˆë²¨ `this`ëŠ” undefined ê°’ì„ ê°€ì§‘ë‹ˆë‹¤. ëª¨ë“ˆì´ ì•„ë‹Œ ìŠ¤í¬ë¦½íŠ¸ì˜ ì „ì—­ ê°ì²´ì—” ê°’ì´ ìˆìŠµë‹ˆë‹¤.

```html run height=0
<script>
  alert(this); // window
</script>

<script type="module">
  alert(this); // undefined
</script>
```

## ë¸Œë¼ìš°ì € íŠ¹ì • ê¸°ëŠ¥

`type="module"`ê°€ ë¶™ì€ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œì˜ ëª¨ë“ˆì€ ì¼ë°˜ì ì¸ ëª¨ë“ˆê³¼ ëª‡ê°€ì§€ ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤.

ìë°”ìŠ¤í¬ë¦½íŠ¸ ì´ˆì‹¬ìë‚˜ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆë‹¤ë©´ ì´ ë‚´ìš©ì€ ë„˜ì–´ê°€ì…”ë„ ë©ë‹ˆë‹¤.

### ëª¨ë“ˆì˜ ì§€ì—° ì‹¤í–‰

ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ì¸ì§€ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì¸ì§€ì— ìƒê´€ì—†ì´ ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ì˜ ì‹¤í–‰ì€ *í•­ìƒ* ì§€ì—°ë©ë‹ˆë‹¤. [](info:script-async-defer) ì±•í„°ì—ì„œ í•™ìŠµí•œ `defer` ì†ì„±ì´ ì ìš©ëœ ê²ƒì²˜ëŸ¼ ë™ì‘í•˜ì£ .

ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì€ íŠ¹ì„±ì„ ë³´ì…ë‹ˆë‹¤.
- ì™¸ë¶€ ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ `<script type="module" src="...">`ëŠ” ë¸Œë¼ìš°ì €ì˜ HTML ì²˜ë¦¬ë¥¼ ë§‰ì§€ ì•ŠìŠµë‹ˆë‹¤.
- HTML ë¬¸ì„œê³¼ ì™„ì „íˆ ì¤€ë¹„ ë  ë•Œê¹Œì§€ ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì€ ëŒ€ê¸° ìƒíƒœì— ìˆìŠµë‹ˆë‹¤.
- ìŠ¤í¬ë¦½íŠ¸ì˜ ìƒëŒ€ì  ìˆœì„œê°€ ìœ ì§€ë©ë‹ˆë‹¤. ìœ„ìª½ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¨¼ì € ì‹¤í–‰í•©ë‹ˆë‹¤.

ì´ëŸ° íŠ¹ì§• ë•Œë¬¸ì— ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì•„ë˜ì— ì •ì˜ëœ HTML ìš”ì†Œë„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ:

```html run
<script type="module">
*!*
  alert(typeof button); // object: ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ìª½ì˜ button ìš”ì†Œë¥¼ 'ì°¸ì¡°'í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
*/!*
  // ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì§€ì—° ë˜ê¸° ë•Œë¬¸ì—, í˜ì´ì§€ê°€ ëª¨ë‘ ë¡œë“œë˜ê³  ë‚œ ë‹¤ìŒì— ì‹¤í–‰ë©ë‹ˆë‹¤.
</script>

<script>
*!*
  alert(typeof button); // Error: ë²„íŠ¼ì€ undefined ìƒíƒœì…ë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ ì•„ë˜ì˜ ìš”ì†Œë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤
*/!*
  // ì¼ë°˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” í˜ì´ì§€ ë‚´ ë‚˜ë¨¸ì§€ ìš”ì†Œê°€ ì²˜ë¦¬ë˜ê¸° ì´ì „ì— ì‹¤í–‰ë©ë‹ˆë‹¤
</script>

<button id="button">Button</button>
```

ì£¼ì˜ ì‚¬í•­: ë‘ë²ˆì§¸ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì²« ë²ˆì§¸ ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë©ë‹ˆë‹¤! ê·¸ë ‡ê¸° ë•Œë¬¸ì— `undefined`ê°€ ë¨¼ì €, `object`ê°€ ë‚˜ì¤‘ì— ì¶œë ¥ë©ë‹ˆë‹¤.

ì´ëŠ” ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ê°€ ì§€ì—° ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë¬¸ì„œ ì „ì²´ê°€ ì²˜ë¦¬ë˜ê¸° ì „ê¹Œì§€ ì‹¤í–‰ë˜ì§€ ì•Šì£ . ë°˜ë©´ ì¼ë°˜ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë°”ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. ê·¸ë˜ì„œ ìœ„ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.

ëª¨ë“ˆ ì‚¬ìš© ì‹œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¤€ë¹„ë˜ê¸° ì „ì— HTML ë¬¸ì„œê°€ ë¨¼ì € ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ í•­ìƒ ì—¼ë‘í•´ì•¼ í•©ë‹ˆë‹¤. ëª‡ëª‡ ê¸°ëŠ¥ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë”©ë˜ê¸° ì „ê¹Œì§€ ë™ì‘í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‹œì ì— íˆ¬ëª… ì˜¤ë²„ë ˆì´ë‚˜ "ë¡œë”© ì¸ë””ì¼€ì´í„°(loading indicator)"ë¥¼ ë³´ì—¬ì£¼ì§€ ì•Šìœ¼ë©´ ì‚¬ìš©ìì˜ í˜¼ë€ì„ ì´ˆë˜í•©ë‹ˆë‹¤.

### ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì˜ ë¹„ë™ê¸°ì„± Async works on inline scripts

`<script async type="module">`ì˜ async ì†ì„±ì€ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì™€ ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ ëª¨ë‘ì— ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ async ì†ì„±ì´ ë¶™ì€ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì„í¬íŠ¸ëœ ëª¨ë“ˆì´ ì²˜ë¦¬ë  ë•Œ ì¦‰ì‹œ ì‹¤í–‰ë©ë‹ˆë‹¤. ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ë‚˜ HTML ë¬¸ì„œì™€ ë…ë¦½ì ìœ¼ë¡œ ë§ì´ì£ . 

For example, the script below has `async`, so it doesn't wait for anyone.

It performs the import (fetches `./analytics.js`) and runs when ready, even if HTML document is not finished yet, or if other scripts are still pending.

That's good for functionality that doesn't depend on anything, like counters, ads, document-level event listeners.

```html
<!-- all dependencies are fetched (analytics.js), and the script runs -->
<!-- doesn't wait for the document or other <script> tags -->
<script *!*async*/!* type="module">
  import {counter} from './analytics.js';

  counter.count();
</script>
```

### External scripts

There are two notable differences of external module scripts:

1. External scripts with same `src` run only once:
    ```html
    <!-- the script my.js is fetched and executed only once -->
    <script type="module" src="my.js"></script>
    <script type="module" src="my.js"></script>
    ```

2. External scripts that are fetched from another domain require [CORS](mdn:Web/HTTP/CORS) headers. In other words, if a module script is fetched from another domain, the remote server must supply a header `Access-Control-Allow-Origin: *` (may use fetching domain instead of `*`) to indicate that the fetch is allowed.
    ```html
    <!-- another-site.com must supply Access-Control-Allow-Origin -->
    <!-- otherwise, the script won't execute -->
    <script type="module" src="*!*http://another-site.com/their.js*/!*"></script>
    ```

    That ensures better security by default.

### No bare modules allowed

In the browser, in scripts (not in HTML), `import` must get either a relative or absolute URL. So-called "bare" modules, without a path, are not allowed.

For instance, this `import` is invalid:
```js
import {sayHi} from 'sayHi'; // Error, "bare" module
// must be './sayHi.js' or wherever the module is
```

Certain environments, like Node.js or bundle tools allow bare modules, as they have own ways for finding modules and hooks to fine-tune them. But browsers do not support bare modules yet.

### Compatibility, "nomodule"

Old browsers do not understand `type="module"`. Scripts of the unknown type are just ignored. For them, it's possible to provide a fallback using `nomodule` attribute:

```html run
<script type="module">
  alert("Runs in modern browsers");
</script>

<script nomodule>
  alert("Modern browsers know both type=module and nomodule, so skip this")
  alert("Old browsers ignore script with unknown type=module, but execute this.");
</script>
```

If we use bundle tools, then as modules are bundled together, their `import/export` statements are replaced by special bundler calls, so the resulting build does not require `type="module"`, and we can put it into a regular script:

```html
<!-- Assuming we got bundle.js from a tool like Webpack -->
<script src="bundle.js"></script>
```

## Build tools

In real-life, browser modules are rarely used in their "raw" form. Usually, we bundle them together with a special tool such as [Webpack](https://webpack.js.org/) and deploy to the production server.

One of the benefits of using bundlers -- they give more control over how modules are resolved, allowing bare modules and much more, like CSS/HTML modules.

Build tools do the following:

1. Take a "main" module, the one intended to be put in `<script type="module">` in HTML.
2. Analyze its dependencies: imports and then imports of imports etc.
3. Build a single file with all modules (or multiple files, that's tunable), replacing native `import` calls with bundler functions, so that it works. "Special" module types like HTML/CSS modules are also supported.
4. In the process, other transforms and optimizations may be applied:
    - Unreachable code removed.
    - Unused exports removed ("tree-shaking").
    - Development-specific statements like `console` and `debugger` removed.
    - Modern, bleeding-edge JavaScript syntax may be transformed to older one with similar functionality using [Babel](https://babeljs.io/).
    - The resulting file is minified (spaces removed, variables replaced with shorter named etc).

That said, native modules are also usable. So we won't be using Webpack here: you can configure it later.

## Summary

To summarize, the core concepts are:

1. A module is a file. To make `import/export` work, browsers need `<script type="module">`, that implies several differences:
    - Deferred by default.
    - Async works on inline scripts.
    - External scripts need CORS headers.
    - Duplicate external scripts are ignored.
2. Modules have their own, local top-level scope and interchange functionality via `import/export`.
3. Modules always `use strict`.
4. Module code is executed only once. Exports are created once and shared between importers.

So, generally, when we use modules, each module implements the functionality and exports it. Then we use `import` to directly import it where it's needed. Browser loads and evaluates the scripts automatically.

In production, people often use bundlers such as [Webpack](https://webpack.js.org) to bundle modules together for performance and other reasons.

In the next chapter we'll see more examples of modules, and how things can be exported/imported.
